"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[179],{572:function(e,s,t){var i,a=(i=t(730))&&i.__esModule?i:{default:i};const r=document.querySelector("#ssatForm"),l=r.elements.ssatText,n=r.elements.ssatUserName,o=r.elements.ssatUserEmail,c=new a.default(r,{validateFieldOnEvent:{event:"blur",afterFirstSubmition:!0,lockInputOnValidation:!1},validateOnSubmit:{lockFormOnValidation:!1,revalidateAllFieldsBeforeSubmition:!1}});c.addField("ssatText",[{validator(e){return e.trim()},errorMessage:"Ошибка"}],{ruleErrorMessages:{on:!0,position:{prepand:".about-us__ssatForm-field-group-ssatText"},removeContainerFromDOMAfterSuccess:!0,classes:["about-us__ssatForm-field-validation-error"]},invalidViewOfField:{on:!0,classes:["about-us__ssatForm-textarea_invalid"]}}).addField("ssatUserName",[{validator(e){return e.trim()},errorMessage:"Ошибка"},{validator(e){return e.match(/^[а-яА-Я\s]{1,40}$/)},errorMessage:"Ошибка"}],{ruleErrorMessages:{on:!0,position:{prepand:".about-us__ssatForm-field-group-ssatUserName"},removeContainerFromDOMAfterSuccess:!0,classes:["about-us__ssatForm-field-validation-error"]},invalidViewOfField:{on:!0,classes:["about-us__ssatForm-input_invalid"]}}).addField("ssatUserEmail",[{validator(e){return!!e.trim()&&e.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},errorMessage:"Ошибка"}],{ruleErrorMessages:{on:!0,position:{prepand:".about-us__ssatForm-field-group-ssatUserEmail"},removeContainerFromDOMAfterSuccess:!0,classes:["about-us__ssatForm-field-validation-error"]},invalidViewOfField:{on:!0,classes:["about-us__ssatForm-input_invalid"]}}).addField("ssatConsent",[{validator(e){return e},errorMessage:"Необходимо согласие"}],{ruleErrorMessages:{on:!0,position:{append:".about-us__ssatForm-consent-checkbox"},removeContainerFromDOMAfterSuccess:!0,classes:["about-us__ssatForm-consent-error_hidden"]},invalidViewOfField:{on:!0,classes:["about-us__ssatForm-consent-checkbox-input_invalid"]}}),c.onSuccess((()=>{fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify({text:l.value,name:n.value,email:o.value}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((e=>e.json())).then((e=>console.log(e)))}),"submit")},829:function(e,s,t){t(342),t(818),t(683)},342:function(e,s,t){t(572)},683:function(e,s,t){t.r(s)},818:function(e,s,t){t.r(s)},730:function(e,s,t){t.r(s),t.d(s,{default:function(){return f}});const i={validateFieldOnEvent:{event:null,afterFirstSubmition:!0,lockInputOnValidation:!1,fieldValueHandler:null,ruleErrorMessages:{on:!0,position:null,container:null,removeContainerFromDOMAfterSuccess:!0,classes:null},successfulValidationMessage:{on:!1,successMessage:null,position:null,container:null,removeContainerFromDOMAfterFail:!0,classes:null},invalidViewOfField:{on:!1,classes:null},validViewOfField:{on:!1,classes:null}},validateOnSubmit:{lockFormOnValidation:!1,revalidateAllFieldsBeforeSubmition:!1}};function a(e,s,t=!1){if(t){const t=function(e){let s=Object.getPrototypeOf(e),t=[];for(;s;){const e=Object.getOwnPropertyNames(s);e.splice(e.indexOf("constructor"),1),t=[...t,...e],s=Object.getPrototypeOf(s)}return[...Object.getOwnPropertyNames(e),...t]}(e);return t.includes(s)}return Object.prototype.hasOwnProperty.call(e,s)}function r(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function l(e,s){const t={};return Object.keys(e).forEach((i=>{a(s,i)?r(e[i])?r(s[i])?t[i]=l(e[i],s[i]):t[i]={...e[i],...s[i]}:t[i]=s[i]:t[i]=e[i]})),Object.keys(s).forEach((i=>{a(e,i)||(t[i]=s[i])})),t}function n(e){try{return e instanceof HTMLElement}catch(e){throw new TypeError("The object is not part of W3 DOM2")}}function o(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}function c(e=""){return e+(65536*(1+Math.random())|0).toString(16).substring(1)}function d(e){return void 0!==e&&e.parentNode}class u extends TypeError{constructor(e){super(e),this.name="ValidationError"}}class f{constructor(e,s={}){const t=this;t.globalConfig=l(i,s),t.eventHandlers=new Map,t.form={},t.form.elem=n(e)?e:document.querySelector(e),t.form.formElements=t.form.elem.elements,t.form.submitting=!1,t.form.isSubmitted=!1,t.fields={},t.validationPromises={},t.callbacks={},t.form.elem.setAttribute("novalidate","novalidate"),t.addListener("submit",t.form.elem,(e=>e.preventDefault()),"preventDefault"),t.addListener("submit",t.form.elem,t.validateOnSubmit.bind(t),"validationOnSubmit")}addListener(e,s,t,i){const a=this;let r=null;return Object.values(a.fields).forEach((e=>{e.elem===s&&(r=e)})),(r?r.eventHandlers:a.eventHandlers).set({handlerName:i,type:e},t),s.addEventListener(e,t),a}removeListener(e,s,t){const i=this;let a=null;i.fields.forEach((e=>{e.elem===s&&(a=e)}));const r=a?a.eventHandlers:i.eventHandlers;return r.keys().forEach((i=>{i.type===e&&i.handlerName===t&&(s.removeEventListener(i.type,r.get(i)),r.delete(i))})),i}addField(e,s,t={}){const i=this;if(!Array.isArray(s))return i;if(0===s.length)return i;let r=null;if(r=n(e)?e:a(i.form.formElements,e)?i.form.formElements[e]:document.querySelector(e),!r)return i;const o=r.getAttribute("name")||`simpowerValidationField${Object.keys(i.fields).length}`;return t=l(i.globalConfig.validateFieldOnEvent,t),i.fields[o]={elem:r,defaultValue:r.defaultValue,rules:s,eventHandlers:new Map,isValid:!1,isPotentiallyValid:!1,wasValidated:!1,successMessage:null,errorMessage:null,errorMessageIsShown:!1,successMessageIsShown:!1,config:t},i.setValidationRules(e),i.fields[o].config.propertiesToBeRestoreAfterRefresh={isValid:i.fields[o].isValid,isPotentiallyValid:i.fields[o].isPotentiallyValid,wasValidated:i.fields[o].wasValidated},i}setValidationRules(e){const s=this;e=s.getFieldObject(e);const t={submit:[]};e.rules.forEach((s=>{let i=null;a(s,"event")&&s.event&&"string"==typeof s.event?i=s.event:a(e.config,"event")&&e.config.event&&"string"==typeof e.config.event&&(i=e.config.event),i?a(t,i)?t[i].push(s):t[i]=[s]:t.submit.push(s)})),e.rulesByEvent=t,Object.keys(e.rulesByEvent).forEach((t=>{"submit"!==t&&s.addListener(t,e.elem,s.validateOnFieldEvent.bind(s),`validateOnField${o(t)}`)}))}removeField(e){const s=this;return(e=s.getFieldObject(e)).eventHandlers.keys().forEach((t=>{s.removeListener(t.type,e.elem,t.handlerName)})),s.deleteSuccesses(e),s.deleteErrors(e),Object.keys(s.fields).forEach((t=>{s.fields[t]===e&&delete s.fields[t]})),s}getFieldValue(e){let s=null;const t=this.getFieldObject(e),{elem:i}=t;switch(i.type){case"checkbox":s=i.checked;break;case"file":s=i.files;break;default:s=i.value}return a(e.config,"fieldValueHandler")&&e.config.fieldValueHandler&&(s=e.config.fieldValueHandler(s)),s}getFieldObject(e){return"object"==typeof e?e:this.fields[e]}clearFields(e=null){const s=this;if(e){const t=s.getFieldObject(e);switch(t.elem.type){case"checkbox":t.elem.checked=t.defaultValue;break;case"file":t.elem.files=t.defaultValue;break;default:t.elem.value=t.defaultValue}}else s.form.elem.reset()}restoreFieldsProperties(e=null,s=["isValid","isPotentiallyValid","wasValidated"]){(e?[this.getFieldObject(e)]:Object.values(this.fields)).forEach((e=>{s.forEach((s=>{e[s]=e.config.propertiesToBeRestoreAfterRefresh[s]}))}))}refresh(e=null){const s=this;s.clearFields(e),s.deleteMessages(e,!0),s.restoreFieldsProperties(e)}isFieldValid(e){let s=!0;return(e=this.getFieldObject(e)).isPotentiallyValid?(e.isValid||(s=!1),s):(s=!1,s)}isFormValid(){const e=this;let s=!0;return Object.values(e.fields).forEach((t=>{e.isFieldValid(t)||(s=!1)})),s}async validateOnSubmit(e){const s=this;if(s.form.submitting)return;const t=s.globalConfig.validateOnSubmit;t.lockFormOnValidation&&s.lockForm(),a(s.callbacks,"onStartValidationSubmit")&&await s.callbacks.onStartValidationSubmit(e,s.form),s.form.submitting=!0,s.form.isSubmitted=!0,await Promise.all(Object.values(s.validationPromises));const i=[];Object.keys(s.fields).forEach((e=>{const a=s.getFieldObject(e);if(!a.wasValidated||t.revalidateAllFieldsBeforeSubmition){const t=c(e);s.validationPromises[t]=s.validateField(a).then((e=>{a.successMessage=e.toString()})).catch((e=>{if("ValidationError"!==e.name)throw e;a.errorMessage=e.message.toString()})).finally((()=>{s.setViewOnFields(a),s.deleteMessages(a),s.createMessages(a),s.renderMessages(a),delete s.validationPromises[t]})),i.push(s.validationPromises[t])}})),await Promise.all(i),s.isFormValid()?(a(s.callbacks,"onSuccessSubmit")&&await s.callbacks.onSuccessSubmit(e,s.form),s.form.isSubmitted=!1,s.refresh()):(a(s.callbacks,"onFailSubmit")&&await s.callbacks.onFailSubmit(e,s.form),s.restoreFieldsProperties(null,["wasValidated"])),a(s.callbacks,"onEndValidationSubmit")&&await s.callbacks.onEndValidationSubmit(e,s.form),s.form.submitting=!1,t.lockFormOnValidation&&s.unlockForm()}async validateOnFieldEvent(e){const s=this,{target:t,type:i}=e,r=Object.keys(s.fields).find((e=>s.fields[e].elem===t)),l=s.getFieldObject(r);if(l.config.afterFirstSubmition&&!s.form.isSubmitted)return;const n=o(i);l.config.lockInputOnValidation&&l.elem.setAttribute("disabled",""),a(s.callbacks,`onStartValidation${n}`)&&await s.callbacks[`onStartValidation${n}`](e,l);const d=c(r);s.validationPromises[d]=s.validateField(l).then((async t=>{l.successMessage=t.toString(),a(s.callbacks,`onSuccess${n}`)&&await s.callbacks[`onSuccess${n}`](e,l)})).catch((async t=>{if("ValidationError"!==t.name)throw t;l.errorMessage=t.message.toString(),a(s.callbacks,`onFail${n}`)&&await s.callbacks[`onFail${n}`](e,l)})).finally((async()=>{l.config.lockInputOnValidation&&l.elem.removeAttribute("disabled"),s.setViewOnFields(l),s.deleteMessages(l),s.createMessages(l),s.renderMessages(l),delete s.validationPromises[d],a(s.callbacks,`onEndValidation${n}`)&&await s.callbacks[`onEndValidation${n}`](e,l)}))}async validateField(e){const s=this;(e=s.getFieldObject(e)).wasValidated=!0;for(const t of e.rules)try{await s.validateRule(e,t)}catch(s){throw e.isValid=!1,s}return e.isValid=!0,a(e.config,"successMessage")?e.config.successMessage:"Validation succeeded"}async validateRule(e,s){let t;e=this.getFieldObject(e);const i=this.getFieldValue(e);if(t=!a(s,"validator")||await s.validator(i),r(t)||(t={result:t}),!t.result)throw a(t,"errorMessage")||(t.errorMessage="Rule validation failed",a(s,"errorMessage")&&(t.errorMessage=s.errorMessage)),s.isValid=!1,e.isPotentiallyValid=!1,new u(t.errorMessage);s.isValid=!0,e.isPotentiallyValid=!0,e.rules.forEach((s=>{a(s,"isValid")&&(s.isValid||(e.isPotentiallyValid=!1))}))}onStartValidation(e,s){return this.callbacks[`onStartValidation${o(s)}`]=e,this}onEndValidation(e,s){return this.callbacks[`onEndValidation${o(s)}`]=e,this}onSuccess(e,s){return this.callbacks[`onSuccess${o(s)}`]=e,this}onFail(e,s){return this.callbacks[`onFail${o(s)}`]=e,this}createMessages(e=null){const s=this;(e?[s.getFieldObject(e)]:Object.values(s.fields)).forEach((e=>{!s.isFieldValid(e)&&e.config.ruleErrorMessages.on?s.getContainerForMessageText(e).textContent=e.errorMessage:s.isFieldValid(e)&&e.config.successfulValidationMessage.on&&(s.getContainerForMessageText(e).textContent=e.successMessage)}))}deleteMessages(e=null,s=!1){const t=this;(e?[t.getFieldObject(e)]:Object.values(t.fields)).forEach((e=>{const{config:i}=e;t.isFieldValid(e)?(e.errorMessage=null,e.errorMessageIsShown=!1,d(e.errorContainer)&&(e.errorContainer.textContent="",i.successfulValidationMessage.removeContainerFromDOMAfterFail&&e.errorContainer.remove())):(e.successMessage=null,e.successMessageIsShown=!1,d(e.successContainer)&&(e.successContainer.textContent="",i.successfulValidationMessage.removeContainerFromDOMAfterFail&&e.successContainer.remove())),s&&(e.errorMessage=null,e.errorMessageIsShown=!1,e.successMessage=null,e.successMessageIsShown=!1,d(e.successContainer)&&(e.successContainer.textContent="",i.successfulValidationMessage.removeContainerFromDOMAfterFail&&e.successContainer.remove()),d(e.errorContainer)&&(e.errorContainer.textContent="",i.successfulValidationMessage.removeContainerFromDOMAfterFail&&e.errorContainer.remove()))}))}getContainerForMessageText(e){const s=this;let t=null;if(a(e=s.getFieldObject(e),"errorContainer")||s.isFieldValid(e)){if(!a(e,"successContainer")&&s.isFieldValid(e)){const s=e.config.successfulValidationMessage;s.container?e.successContainer=n(s.container)?s.container:document.querySelector(e):(e.successContainer=document.createElement("div"),s.classes&&e.successContainer.classList.add(...s.classes))}}else{const s=e.config.ruleErrorMessages;s.container?e.errorContainer=n(s.container)?s.container:document.querySelector(e):(e.errorContainer=document.createElement("div"),s.classes&&e.errorContainer.classList.add(...s.classes))}return t=s.isFieldValid(e)?e.successContainer:e.errorContainer,t}renderMessages(e=null){const s=this;(e?[s.getFieldObject(e)]:Object.values(s.fields)).forEach((e=>{let t=null,i=null;if(!s.isFieldValid(e)||!function(e){let s=e;return"string"==typeof e&&(s=e.trim()),!s}(s.getFieldValue(e))){if(s.isFieldValid(e)){const s=e.config.successfulValidationMessage;s.on&&(d(e.successContainer)||(t=e.successContainer,i=s.position))}else{const s=e.config.ruleErrorMessages;s.on&&(d(e.errorContainer)||(t=e.errorContainer,i=s.position))}try{!function(e,s={append:null,prepand:null,after:null,before:null}){if(!e)throw new TypeError("ElementToBeInserted parameter is invalid.");if(!s)throw new TypeError("Position parameter is invalid.");let t;if(void 0!==s.append)t="object"==typeof s.append?s.append:document.querySelector(s.append),t.append(e);else if(void 0!==s.prepend)t="object"==typeof s.prepend?s.prepend:document.querySelector(s.prepend),t.prepend(e);else if(void 0!==s.after)t="object"==typeof s.after?s.after:document.querySelector(s.after),t.after(e);else{if(void 0===s.before)throw new TypeError("Position parameter is invalid.");t="object"==typeof s.before?s.before:document.querySelector(s.before),t.before(e)}}(t,i),s.isFieldValid(e)?e.successMessageIsShown=!0:e.errorMessageIsShown=!0}catch(s){if("TypeError"===s.name&&"Position parameter is invalid."===s.message)e.elem.after(t);else if("TypeError"!==s.name&&("ElementToBeInserted parameter is invalid."!==s.message||"Position parameter is invalid."===s.message))throw s}}}))}setViewOnFields(e=null){const s=this;(e?[s.getFieldObject(e)]:Object.values(s.fields)).forEach((e=>{const{elem:t,config:i}=e;s.isFieldValid(e)?(i.invalidViewOfField.classes&&t.classList.remove(...i.invalidViewOfField.classes),i.validViewOfField.on&&i.validViewOfField.classes&&t.classList.add(...i.validViewOfField.classes)):(i.validViewOfField.classes&&t.classList.remove(...i.validViewOfField.classes),i.invalidViewOfField.on&&i.invalidViewOfField.classes&&t.classList.add(...i.invalidViewOfField.classes))}))}lockForm(){const e=this.form.elem.querySelectorAll("input, textarea, button, select");Array.from(e).forEach((e=>{e.setAttribute("disabled",""),e.style.pointerEvents="none",e.style.webkitFilter="grayscale(100%)",e.style.filter="grayscale(100%)"}))}unlockForm(){const e=this.form.elem.querySelectorAll("input, textarea, button, select");Array.from(e).forEach((e=>{e.removeAttribute("disabled"),e.style.pointerEvents="",e.style.webkitFilter="",e.style.filter=""}))}}}},function(e){e(e.s=829)}]);
//# sourceMappingURL=main.305e02aea4f64d7e1f1a.js.map